{% extends "base2.html" %}

{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manage Listings</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <style>
        body {
            background-color: #e3c8a2;
            font-family: 'Georgia', serif;
        }
        .navbar-custom { background-color: #d1a66d; }
        .navbar-custom .navbar-nav .nav-link { color: white; }
        .navbar-custom .navbar-nav .nav-link:hover { color: #fef1dd; }
        .navbar-profile { position: absolute; top: 15px; right: 15px; }
        .navbar-custom .search-bar { width: 70%; }
        .side-navigation {
            background-color: #d1a66d;
            padding: 20px;
            height: 100vh;
            width: 200px;
            border-radius: 10px;
            overflow-y: auto;
        }
        .side-navigation a {
            color: white;
            display: block;
            margin: 10px 0;
            text-decoration: none;
        }
        .side-navigation a:hover { color: #fef1dd; }
        .main-content {
            padding: 20px;
            flex: 1;
        }
        .listing-card {
            background-color: #f7e1b5;
            border: 2px solid #ba8c63;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        .listing-card img {
            max-height: 150px;
            object-fit: cover;
            border-radius: 10px;
        }
        .btn-manage { margin-right: 10px; }
    </style>
</head>
<body>



<!-- Page Layout -->
<div class="d-flex">

    <!-- Side Navigation -->
    <div class="side-navigation">
        <a href="/show_listings/" class="btn btn-dark">Browse All</a>
        <a href="/notifications" class="btn btn-dark">Notifications</a>
        <a href="/message_show/" class="btn btn-dark">Inbox</a>
        <a href="/buying" class="btn btn-dark">Buying</a>
        <a href="/selling" class="btn btn-dark">Selling</a>
        <a href="/listing/create" class="btn btn-dark">Create Listing</a>
        <a href="/manage_listings/" class="btn btn-dark">Manage Listings</a>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <h3 class="mb-4">ðŸ“‹ Your Listings</h3>

        {% for listing in listings %}
        <div class="listing-card row">
            <div class="col-md-3">
                {% if listing.image %}
                <img src="{{ listing.image.url }}" alt="{{ listing.title }}" class="img-fluid">
                {% else %}
                <div class="d-flex align-items-center justify-content-center bg-light text-muted" style="height: 150px; border-radius: 10px;">No Image</div>
                {% endif %}
            </div>
            <div class="col-md-6">
                <h5>{{ listing.title }}</h5>
                <p>{{ listing.description }}</p>
                <strong>â‚¦{{ listing.price }}</strong><br>
                <em>Status: {{ listing.status|capfirst }}</em>
            </div>
            <div class="col-md-3 d-flex align-items-center">
                <form method="POST" class="d-inline me-2">
                    {% csrf_token %}
                    <input type="hidden" name="listing_id" value="{{ listing.listing_id }}">
                    <input type="hidden" name="action" value="sold">
                    <button type="submit" class="btn btn-success btn-manage">Mark as Sold</button>
                </form>
                <form method="POST" class="d-inline">
                    {% csrf_token %}
                    <input type="hidden" name="listing_id" value="{{ listing.listing_id }}">
                    <input type="hidden" name="action" value="cancelled">
                    <button type="submit" class="btn btn-danger btn-manage">Cancel</button>
                </form>
            </div>
        </div>
        {% empty %}
        <p>You don't have any listings yet. <a href="/listing/create">Create one now.</a></p>
        {% endfor %}
    </div>

</div> <!-- End of d-flex -->

</body>
</html>
{% endblock %}