{% extends 'base2.html' %}
{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4" style="font-family: Georgia, serif; font-weight: bold; color: white;">
        Compare Prices for "{{ title }}"
    </h2>

    <div style="background-color: #f9e5c8; padding: 25px; border-radius: 20px; color: black;">

        {% if listings %}
        <h4 style="margin-bottom: 15px; font-weight: bold; color: black;">Internal Listings</h4>
        <table style="width: 100%; border-collapse: collapse; font-family: Georgia, serif; color: black;">
            <thead style="background-color: #e5ba88; color: black;">
                <tr style="text-align: left;">
                    <th style="padding: 10px;">Seller</th>
                    <th style="padding: 10px;">Price</th>
                    <th style="padding: 10px;">Condition</th>
                    <th style="padding: 10px;">Action</th>
                </tr>
            </thead>
            <tbody style="background-color: #fff8e6; color: black;">
                {% for listing in listings %}
                <tr>
                    <td style="padding: 10px;">{{ listing.seller.username }}</td>
                    <td style="padding: 10px;">BDT {{ listing.price }}</td>
                    <td style="padding: 10px;">{{ listing.get_condition_display }}</td>
                    <td style="padding: 10px;">
                        <form action="{% url 'add_to_cart' %}" method="get">
                            <input type="hidden" name="cart_item" value="{{ listing.listing_id }}">
                            <button type="submit" class="btn btn-dark" style="font-weight: bold; font-size: 0.95rem; padding: 8px 16px; border-radius: 8px;">
                                ðŸ›’ Add to Cart
                            </button>
                            
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p style="color: black;">No internal listings available for this book.</p>
        {% endif %}

        {% if external_sources %}
        <h4 class="mt-4" style="margin-top: 30px; font-weight: bold; color: black;">External Sources</h4>
        <table style="width: 100%; border-collapse: collapse; font-family: Georgia, serif; color: black;">
            <thead style="background-color: #e5ba88; color: black;">
                <tr style="text-align: left;">
                    <th style="padding: 10px;">Source</th>
                    <th style="padding: 10px;">Price</th>
                    <th style="padding: 10px;">Link</th>
                </tr>
            </thead>
            <tbody style="background-color: #fff8e6; color: black;">
                {% for source in external_sources %}
                <tr>
                    <td style="padding: 10px;">{{ source.source_name }}</td>
                    <td style="padding: 10px;">BDT {{ source.price }}</td>
                    <td style="padding: 10px;">
                        <a href="{{ source.url }}" class="btn btn-outline-dark btn-sm" target="_blank">View Source</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p style="color: black;">No external price sources found.</p>
        {% endif %}
    </div>

    <div class="text-center mt-4">
        <a href="{% url 'compare_prices' %}" class="btn btn-secondary">Back to All Books</a>
    </div>
</div>
{% endblock %}
